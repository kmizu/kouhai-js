# 第16話 シンクロする思考と、小さなご褒美

「じゃあ、お願いしようかな」

　僕がそう言うと、美久は「はい！」と力強く頷き、キーボードに向き合った。僕たちはまず、`>`や`==`といった、比較演算子の実装から取り掛かった。

「これは、前にやった四則演算の時と同じパターンでいけるな。僕たちの`operations`っていう『道具箱』に、新しい道具を追加してあげるだけでいい」

　僕の方針説明に、美久はもう迷わなかった。一度経験した作業だ。彼女は、自信を持った手つきで、`operations`オブジェクトに新しい定義を書き加えていく。

`'>': (a, b) => a > b,`
`'<': (a, b) => a < b,`
`'==': (a, b) => a == b,`

　そのスムーズなタイピングを見ながら、僕は彼女の確かな成長を実感していた。

「よし。じゃあ、いよいよ本丸の`if`文だ」

　僕は`evaluate`関数の中に、`if (exp[0] === 'if')`という新しい分岐を追加した。

「さて、美久。ここからが、少しだけ頭を使う面白いところだ」
「はい……！」
「`if`文には、`condition`、`true-exp`、`false-exp`っていう、三つのパーツがある。こいつらを、全部いきなり評価しちゃっていいと思うか？」

　僕の問いかけに、美久は人差し指を顎に当てて、少し考える素振りを見せた。そして、何か閃いたように、ぱっと顔を上げた。

「ううん……ダメな気がします。だって、もし`condition`が`true`だったら、`false-exp`の方は、実行する必要がないですもんね？」

　その答えを聞いた瞬間、僕は思わず膝を打った。

「その通りだ！　すごいな、美久！」

　僕たちの思考が、綺麗にシンクロした。この感覚が、たまらなく心地いい。

「先に`condition`だけを評価して、その結果によって、次に何を評価するかを『選択』するんだ。まさに、`if`文そのものだな」

　僕がロジックを口頭で説明し、美久がそれをコードに翻訳していく。まるで、息の合ったセッションのようだ。

```javascript
    if (exp[0] === 'if') {
      const condition = exp[1];
      const trueExp = exp[2];
      const falseExp = exp[3];

      const result = evaluate(condition, env);
      if (result === true) {
        return evaluate(trueExp, env);
      } else {
        return evaluate(falseExp, env);
      }
    }
```

　そして、テストコードを実行する。

`console.log(evaluate(['if', ['==', 10, 10], 'Correct!', 'Wrong!'], env));`

　画面に、はっきりと`Correct!`の文字が表示された。

「やった……！　先輩、私たち、天才じゃないですか！？」

　美久が、満面の笑みで僕に振り向いた。その、あまりに無邪気で、嬉しそうな表情に、僕は思わず、手を伸ばしていた。

　くしゃり、と彼女の柔らかい髪を、撫でる。

「……よく、頑張ったな」

　その言葉は、ほとんど無意識に口から出ていた。

「え……」

　美久が、大きな瞳をぱちくりさせ、次の瞬間には、顔をみるみるうちに真っ赤にして、固まってしまった。
　僕もまた、自分のした行動に、はっと我に返る。

（な、何やってんだ、俺は……！）

　慌てて手を引っ込めると、教室に、甘酸っぱくて、最高に気まずい沈黙が流れた。

「……あ、いや、その、つい……調子に乗った。すまん」
「い、いえ！　そ、その……あ、ありがとうございました……！」

　しどろもどろに交わされる、意味不明な会話。プログラミングのロジックは解けても、僕たちの間に流れる、この恋のロジックは、二人にとって、まだ一番の難問のようだった。