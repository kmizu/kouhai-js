# 第4話 四則演算と、パターンの発見

「すごい……本当に『3』って出てる……」

　美久は、ディスプレイに表示されたたった一文字の数字を、まるで奇跡でも見るかのように見つめている。その純粋な感動が、僕にも伝わってくるようだった。

「じゃあ、先輩！　他の計算もできるんですか？　引き算とか、掛け算とか！」
「ああ、もちろん。一度『翻訳』の仕組みを作ってしまえば、あとは応用だ。新しいルールを、僕たちの評価器に教えてやればいい」

　僕はそう言って、`evaluate`関数に新しいコードを書き足し始めた。

「まずは引き算からだ。『もし、リストの最初の言葉が `-` だったら、引き算をする』っていうルールを追加する」

```javascript
    if (operator === '+') {
      return evaluate(operand1) + evaluate(operand2);
    }
    if (operator === '-') {
      return evaluate(operand1) - evaluate(operand2);
    }
```

「あ……！」

　僕がコードを打ち終わるか終わらないかのうちに、美久が声を上げた。

「さっきの足し算のルールと、ほとんど同じですね！　プラスがマイナスに変わっただけ！」
「その通り。やることは同じだからな。じゃあ、この調子で掛け算と割り算も追加してしまおう」

　僕は同じように、`*` と `/` のルールを書き加えていく。

```javascript
    if (operator === '*') {
      return evaluate(operand1) * evaluate(operand2);
    }
    if (operator === '/') {
      return evaluate(operand1) / evaluate(operand2);
    }
```

「割り算のところ、美久が打ってみるか？」
「えっ！？　い、いいんですか？」
「もちろん。僕たちの『共同開発』なんだから」

　僕が少しだけキーボードから離れると、美久はおそるおそる、人差し指でキーを叩き始めた。慣れない手つきで、一文字一文字、確かめるように打ち込んでいく。その真剣な横顔を、僕はなんだか眩しい気持ちで見つめていた。

「……できました」

　ほっとしたように息をつく美久。これで、僕たちの言語は四則演算すべてに対応できるようになったはずだ。

「じゃあ、試してみよう」

　僕はテスト用のコードをいくつか実行してみせた。

`console.log(evaluate(['-', 10, 3]));`  // -> 7
`console.log(evaluate(['*', 5, 6]));`   // -> 30
`console.log(evaluate(['/', 20, 4]));`  // -> 5

　画面には、次々と正しい計算結果が表示される。美久は「おおーっ」と小さく歓声をあげ、自分の打ったコードが正しく動いていることに、いたく感動している様子だった。
　しばらく、満足そうに完成したコードを眺めていた彼女だったが、ふと、何かに気づいたように首を傾げた。

「先輩。こうして見てみると……」
「ん？」
「演算子の部分が違うだけで、やってること、全部同じじゃないですか？　『もし〇〇だったら、△△する』っていう、同じ形の繰り返し……」

　僕は、思わず目を見開いた。

（気づいたか……！）

「すごいな、美久。その通りだ。プログラミングでは、こういう風に『同じような処理の繰り返し』、つまり**パターン**を見つけることが、すごく重要なんだ」
「パターン、ですか」
「ああ。今は一つ一つバラバラにルールを書いているけど、このパターンを利用すれば、もっとずっと賢くて、短いコードで同じことができるようになる。でも、それはまた今度の話だ」

　まずは、自分の力でこのパターンに気づけたことが、何よりの収穫だった。

「なんだか、プログラミングってパズルみたいですね」

　美久が、ぽつりと言った。

「ルールを見つけて、それを綺麗に当てはめていく感じが。ちょっと、楽しいです」
「……そうか」

　その言葉が、なぜだか無性に嬉しかった。
　僕がずっと一人で楽しんでいたこのパズルの面白さを、共有できる相手がいる。ただそれだけのことが、こんなにも心を温かくするなんて。

　僕たちの間には、もう「教える先輩」と「教わる後輩」というだけじゃない、何か新しい関係が芽生え始めているのかもしれない。そんな予感が、胸をかすめていった。