# 第13話 非同期という言葉

　火曜日の放課後。プログラミング部の部室に、部員が何人かいる中で、美久がやってきた。

「あの...嵐山先輩」

　他の部員もいるので、いつもより距離を置いて話しかけてくる美久。

「どうしたの？」

　僕も事務的な口調で返す。

「プログラミングで、わからないところがあって...」

　美久がノートパソコンを見せる。エラーメッセージが表示されている。

「ああ、これは非同期処理の問題だね」

　他の部員の目を気にしながら、説明を始める。

「非同期処理？」

「setTimeoutとか、処理を遅らせて実行する機能。たとえば...」

```javascript
console.log('1番目');

setTimeout(() => {
    console.log('2番目？');
}, 1000);

console.log('3番目');
```

「これを実行すると、1番目、3番目、2番目の順で表示される」

「え？順番が変わるんですか？」

「そう。setTimeoutは指定時間後に処理を実行するから、その間に次の処理が進む」

　美久が真剣にメモを取っている。他の部員も自分の作業をしているから、そんなに目立たない。少し安心する。

「Promiseっていうのもあって、これは約束みたいなもの」

　説明しながら、この言葉を口にするのが少し辛い。

```javascript
const promise = new Promise((resolve, reject) => {
    // 何か処理をして
    resolve('成功しました');
});

promise.then(result => {
    console.log(result); // '成功しました'と表示
});
```

「約束は必ず守られるんですか？」

　美久の質問に、ドキッとする。プログラミングの話のはずなのに、別の意味に聞こえる。

「そうだね、正しく書けば必ず返ってくる」

　でも、現実の約束はどうだろう。美久に「また明日」と言った約束を、僕は守れているだろうか。

「非同期処理は、同時進行する複数の物語みたいなもの」

　なんとか説明を続ける。

「複数の物語...」

　美久が何か考え込んでいる。

「みくの小説でも、複数の視点で同時に物語が進むことがあるでしょ？」

「はい。でも、それをどう表現するか、いつも悩みます」

「プログラミングも同じ。非同期処理は便利だけど、管理が難しい」

　二人の間に、微妙な空気が流れる。技術的な話をしているのに、どこか別の意味を含んでいるような。

「先輩」

　美久が小さな声で言う。

「ん？」

「Promise...約束って、破られることもありますよね」

　心臓が痛い。

「プログラミングでは、エラー処理をちゃんと書けば大丈夫」

　逃げるような答えをする。

「現実では？」

　美久がまっすぐ見つめてくる。他の部員は気づいていないけど、二人の間の空気が変わった。

「それは...」

　言葉に詰まる。

　ちょうどその時、部長が声をかけてきた。

「おー、美久ちゃん、順調？」

「は、はい。先輩に教えてもらって」

「隆弘はいい先生だからな」

　部長は気さくに話しかけてくるけど、僕たちの微妙な空気には気づいていない。

　結局、それ以上深い話はできなかった。美久は礼を言って、部室を出て行った。

　一人になってから、さっきの会話を思い返す。Promise、約束。非同期処理。

　美久との関係も、今は非同期になっている。同じ時間を過ごしているのに、心がずれている。それをどう同期させればいいのか、わからない。

　窓の外を見ると、もう日が暮れ始めている。美久はもう帰ったかな。一緒に帰りたい気持ちはあるけど、一歩が踏み出せない。

（臆病だな、僕は）

　自分に呆れながら、作業を続ける。

　でも、集中できない。美久の「約束って、破られることもありますよね」という言葉が、頭から離れない。

　僕は、美久との約束を破っているのかもしれない。明確な約束じゃないけど、一緒にいるという暗黙の約束を。

　スマホを見ると、美久からLINEが来ていた。

『今日はありがとうございました。非同期処理、難しいですね』

　そして、少し間を置いて、もう一つ。

『でも、いつかは同期できると信じてます』

　その言葉に、胸が締め付けられる。

　返事を打とうとして、止まる。何を返せばいいんだろう。

　結局、

『頑張って』

　とだけ送った。

　既読はすぐについたけど、返事はない。きっと、がっかりさせてしまった。

（情けない）

　自分の臆病さが嫌になる。でも、まだ踏み出せない。美久との距離を、元に戻す勇気が。