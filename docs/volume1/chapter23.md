# 第23話「約束（Promise）」

　`setTimeout`や`setInterval`を駆使し、僕たちのゲームは、細部にまでこだわった演出が施されるようになった。美久は、自分のアイデアがコードによって形になり、ゲームに命が吹き込まれていくことに、心底喜びを感じている。その姿は、僕のプログラミングへの情熱を、さらに深く燃え上がらせた。

「先輩、このゲーム、セーブデータを読み込む時に、一瞬画面が固まるんですけど、これってどうにかなりませんか？」

　美久が、ふとそんな質問をしてきた。彼女の視線は、すでにゲームの「快適性」へと向かっている。プレイヤーがストレスなくゲームを楽しめるように、細かな部分にまで気を配る。その探究心に、僕は感心した。

「いいところに気づいたな、美久。それは、非同期処理に関わる問題だ。そこで登場するのが、Promiseだ」

　僕は、ホワイトボードに「Promise」と書いた。Promiseは、JavaScriptで非同期処理を扱うための仕組みだ。非同期処理とは、時間がかかる処理を、プログラムの実行を止めずに裏側で進めることだ。例えば、セーブデータの読み込みや、インターネットから画像をダウンロードする、といった処理がこれにあたる。

「Promiseは、『いつか終わる処理』を待つための『約束』みたいなものだ。例えば、美久が誰かに『明日、お菓子を持ってくるね』って約束したとするだろ？ そのお菓子が、明日ちゃんと手に入るかどうかは、その時になってみないと分からない。でも、美久はその『約束』を信じて、待つことができる」

　僕の例えに、美久は「なるほど！」と頷いた。その瞳は、まるで魔法を見たかのように輝いている。

「そう。プログラムも同じで、セーブデータの読み込みみたいに、時間がかかる処理は、いつ終わるか分からない。でも、Promiseを使えば、『この処理が終わったら、次のことをするよ』っていう『約束』を立てて、プログラムをスムーズに動かし続けることができるんだ」

　僕は、簡単なPromiseのコードを書いて見せた。`new Promise((resolve, reject) => { ... });`。そして、`then()`で成功した時の処理を、`catch()`で失敗した時の処理を書くことを説明した。

「わあ！ これって、まるで、未来の出来事を予約するみたいですね！」

　美久が、興奮冷めやらぬ様子で、僕が書いたコードを食い入るように見つめている。彼女の言葉を聞いて、僕も改めて、この技術の持つ可能性に気づかされた。単に処理を待つだけじゃない。これこそが、僕たちのゲームを「滑らか」に動かし、プレイヤーにストレスを感じさせないための、重要な技術なのだ。

「そう。非同期処理は、ゲームを快適にするためには不可欠な技術だ。特に、ノベルゲームみたいに、大量のデータを読み込んだり、複雑な演出をしたりする時には、このPromiseが活躍する」

　僕の言葉に、美久は深く頷いた。彼女の頭の中では、すでに、僕たちのゲームが、よりスムーズに、より快適に動いている光景が描かれているのだろう。

「先輩、非同期処理は『いつか終わる処理』を待つ約束……。なんだか、私たちみたいですね」

　美久が、ふと、そんなことを呟いた。その言葉を聞いた瞬間、僕の心臓が、ドクンと大きく跳ねた。僕も、同じことを考えていたからだ。美久と僕の関係もまた、このPromiseのように、「いつか」訪れる未来を信じて、今を積み重ねている。そんな淡い期待が、僕の胸を締め付ける。

　僕は、美久の言葉に、何も答えることができなかった。ただ、彼女の潤んだ瞳を見つめ返すことしかできない。部室に、甘く、そして切ない沈黙が流れる。この関係が、いつか「解決（resolve）」する日が来るのだろうか。それとも、このまま「拒否（reject）」されてしまうのだろうか。そんな不安と、期待が入り混じった感情が、僕の胸を満たしていた。

　僕たちは、実際にセーブデータの読み込み処理にPromiseを組み込んでみた。ゲームを起動し、セーブデータをロードする。すると、以前のような画面の固まりはなく、スムーズにゲームが再開された。美久は「すごい！ 全然固まらない！」と歓声を上げた。

　プログラミングは、単なる技術じゃない。それは、僕たちの「想い」を、具体的な形にするための、そして、誰かの「心」を揺さぶるための、最高のツールだ。Promiseという、たった一つの概念を学ぶだけで、美久はこんなにも目を輝かせ、そして、僕たちはこんなにも、お互いの「未来」を意識し合っている。その姿を見ていると、僕の胸にも、温かいものがこみ上げてきた。

　僕たちのノベルゲーム制作は、Promiseという強力な武器を手に入れた。これで、より快適で、プレイヤーにストレスを感じさせないゲームを創り出すことができるだろう。そして、僕たちの関係もまた、このPromiseのように、お互いの「約束」を信じ、未来へと進んでいくのだろう。そんな予感が、僕の胸を、優しく、そして強く、締め付けた。

◇◇◇◇
