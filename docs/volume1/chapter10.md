# 第10話 選択肢システムの実装

## 10月13日（木）午前7時30分

「隆弘くん、今日も一緒に行こう」

いつものように美久が待っている。でも、今朝はなんだか様子が違う。

「どうかした？」

「ううん、なんでもない」

そう言いながらも、美久の頬がほんのり赤い。

（もしかして、昨日のフラグの話を考えてる？）

エレベーターの中、いつもより距離が近い気がする。

「あのね、隆弘くん」

「ん？」

「今日は、選択肢の実装でしょ？」

「ああ、DOM操作を使ってね」

「楽しみ！」

美久の笑顔を見て、僕も自然と笑顔になる。

◇◇◇◇

## 午後4時30分　プログラミング部室

「今日は、いよいよ選択肢をクリックできるようにする」

僕はエディタを開き、説明を始めた。

「DOM操作って何ですか？」

「Document Object Modelの略で、HTMLの要素をJavaScriptで操作する仕組みだよ」

美久が真剣にメモを取る。

「例えば、こんな感じ」

```javascript
// HTML要素を取得
const textBox = document.getElementById('text-box');
const choicesContainer = document.getElementById('choices');

// テキストを表示する関数
function displayText(text) {
    textBox.innerText = text;
}

// 選択肢を表示する関数
function displayChoices(choices) {
    // 既存の選択肢をクリア
    choicesContainer.innerHTML = '';
    
    // 新しい選択肢を作成
    choices.forEach((choice, index) => {
        const button = document.createElement('button');
        button.innerText = choice.text;
        button.onclick = () => selectChoice(index);
        choicesContainer.appendChild(button);
    });
}
```

「わあ、本格的！」

美久の目が輝く。

「これで、画面に選択肢ボタンが表示される」

「クリックしたら、どうなるんですか？」

「selectChoice関数が呼ばれて、次のシーンに進む」

```javascript
function selectChoice(choiceIndex) {
    const currentScene = scenes[player.currentScene];
    const selectedChoice = currentScene.choices[choiceIndex];
    
    // アクションがあれば実行
    if (selectedChoice.action) {
        selectedChoice.action();
    }
    
    // 次のシーンへ
    player.currentScene = selectedChoice.next;
    displayScene(player.currentScene);
}
```

「なるほど！これで運命の分岐点が作れるんですね」

美久の言葉に、僕はドキッとした。

運命の分岐点。確かに、ゲームでも現実でも、選択は運命を変える。

◇◇◇◇

## 午後5時30分　実装作業

「じゃあ、実際に動かしてみよう」

画面に、最初のシーンが表示される。

『4月、新学期。私の物語が始まる――』

その下に、二つの選択肢ボタン。

［教室に入る］［少し待つ］

「美久、クリックしてみて」

「え、私が？」

「うん。最初の選択は美久に」

美久は緊張した面持ちで、マウスを握る。

そして、［教室に入る］をクリック。

画面が切り替わり、次のテキストが表示された。

『教室に入ると、そこには見覚えのある後ろ姿が――』

「動いた！本当に動いた！」

美久が歓声を上げる。

「これが、DOM操作の力だよ」

「すごい……まるで本物のゲームみたい」

いや、これは本物のゲームだ。

僕たちが作っている、正真正銘のノベルゲーム。

◇◇◇◇

## 午後6時　選択肢の追加

「もっと選択肢を増やしてみよう」

僕たちは、シーンデータにどんどん選択肢を追加していく。

```javascript
{
    id: 5,
    background: "corridor.jpg",
    character: "none",
    text: "廊下で先輩とすれ違った。",
    choices: [
        { text: "おはようございます！", next: 6, action: () => affection.senpai += 5 },
        { text: "会釈だけする", next: 7, action: () => affection.senpai += 2 },
        { text: "気づかないふり", next: 8, action: () => affection.senpai -= 3 }
    ]
}
```

「3択！」

「現実でもこんな選択肢が見えたらいいのに」

美久の呟きに、僕は苦笑する。

「でも、見えたら逆に選べなくなりそう」

「確かに。どれが正解か分からないから面白いんですよね」

そう言いながら、美久は画面を見つめる。

「隆弘先輩」

「ん？」

「もし、現実で『告白する』っていう選択肢があったら、選びますか？」

突然の質問に、心臓が跳ねる。

「それは……相手による、かな」

「じゃあ、相手が……」

美久が何か言いかけて、でも首を振った。

「なんでもないです。続けましょう」

モヤモヤした気持ちを抱えながら、作業を続ける。

◇◇◇◇

## 午後7時30分　デバッグとテスト

「一通り実装できたね」

画面には、複数のシーンと選択肢が実装されたゲームが動いている。

「本当に私たちが作ったんですね」

美久が感慨深げに言う。

「まだまだ改良の余地はあるけどね」

「でも、すごいです。選択肢をクリックして、物語が進んで」

美久は何度も選択肢を選び直して、異なるルートを確認している。

その姿を見ていて、ふと思う。

僕たちの関係も、いくつもの選択肢の結果なのかもしれない。

あの日、美久がプログラミングを教えて欲しいと言ってくれた選択。

僕が快諾した選択。

お互いの趣味を打ち明けた選択。

すべての選択が、今につながっている。

◇◇◇◇

## 午後8時　帰り道

「今日もありがとうございました」

マンションへの道を歩きながら、美久が言う。

「DOM操作、難しかったけど面白かったです」

「美久の飲み込みが早くて助かるよ」

「だって、隆弘先輩の教え方が上手だから」

褒められて、照れてしまう。

「ねえ、隆弘先輩」

「ん？」

「もし、今、選択肢が出たら何て書いてあると思います？」

美久が立ち止まって、僕を見上げる。

月明かりに照らされた彼女の顔は、いつもより大人っぽく見えた。

「そうだな……」

［手を繋ぐ］
［気持ちを伝える］
［このまま歩き続ける］

頭の中に、そんな選択肢が浮かぶ。

でも、現実には選択肢は見えない。

「分からないな。でも……」

「でも？」

「どの選択肢を選んでも、美久と一緒ならハッピーエンドな気がする」

僕の言葉に、美久の顔が真っ赤になった。

「ず、ずるいです、そんな言い方」

でも、嬉しそうに微笑む美久。

その笑顔を見て、僕は確信した。

これは、正しい選択肢を選んだ結果なんだと。

明日も、美久と一緒にゲームを作る。

その選択に、後悔はない。