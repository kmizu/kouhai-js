# 第20話 関数という名の「約束」

　相沢が嵐のように去った後、教室には、少しだけ気まずいような、それでいて、奇妙な連帯感のようなものが漂っていた。
　その沈黙を破ったのは、美久だった。

「……先輩」
「ん？」
「さっきの人が言ってた、『くろーじゃ』って、何なんですか？」

　その質問を、僕は待っていた。待っていたかのように、にやりと口の端を吊り上げた。

「いいところに目をつけたな、美久。でもな、クロージャを理解するには、まず、その親玉である『関数』っていう概念を、僕たちの言語に実装しないといけない」
「関数……」
「ああ。今までで、一番大きな機能追加になる。そして、これができれば、僕たちの言語は、もう『おままごと』なんて、絶対に言わせないレベルになる」

　僕は、エディタに向き直り、彼女に宣言した。

「関数っていうのは、一言で言えば、『一連の処理に名前をつけて、いつでも呼び出せるようにしておく仕組み』だ。僕たちが今まで作ってきた、`+`や`*`みたいな基本的な『お願い』を、今度は、僕たち自身の手で、自由に、いくつでも作れるようになるんだ」

　僕は、関数を定義するための、新しいキーワード`lambda`（ラムダ）を使った構文を、画面に打ち出した。

`['define', 'add', ['lambda', ['x', 'y'], ['+', 'x', 'y']]]`

「`lambda`は、『ここからが関数の定義だよ』っていう、特別な合図だ。それに続くのが、関数が受け取る値の名前、『引数』（ひきすう）。そして、最後のリストが、実際に行う処理。この一行で、『`add`という名前で、二つの数を受け取って、それを足し算する関数』を、僕たちは定義したことになる」

　そして、僕は、相沢が口にした「クロージャ」の概念の、ほんのさわりの部分だけを、彼女に伝えた。

「関数はな、美久。ただの処理の塊じゃないんだ。もっと特別で……関数が作られた『瞬間』の『世界（環境）』を、まるごと写真に撮るみたいに、記憶してるんだ。そして、いつでも、その時の世界のことを思い出しながら、仕事をしてくれる。その、記憶を持った、賢い関数のことを、クロージャって言うんだ」

　美久は、まだ完全には理解できていないようだった。でも、「記憶を持った関数……」と、その不思議な言葉の響きを、自分の心の中で反芻しているようだった。

「……なんだか、すごく、難しそうですね」
「ああ。正直に言って、今までで一番の難関だ。今の僕たちの言語の仕組みを、根本から見直さないといけないかもしれない。でも……」

　僕は、彼女の目を、真っ直ぐに見つめて言った。

「相沢のヤツに、おままごとだなんて言わせっぱなしじゃ、悔しいだろ？」

　その言葉は、魔法だったらしい。僕の言葉を聞いた瞬間、美久の瞳に、再び、あの強く、挑戦的な光が宿った。

「……はい！」

　彼女は、椅子から立ち上がらんばかりの勢いで、力強く頷いた。

「私、やります！　先輩と一緒に、その、くろーじゃ？を作って、あの人を、ぎゃふんと言わせてやりたいです！」

　その姿を見て、僕の心にも、熱い火が灯った。もう、僕たちの間に、迷いはなかった。相沢の挑発は、結果的に、僕たちの目標を、より高く、より明確なものへと、引き上げてくれたのだ。

　これから始まる、最大の挑戦。それは、僕たちの言語が、本物の翼を持つための、大きな、大きな一歩だ。

　第一部、終わり。そして、僕と彼女の、本当の物語の、始まり。